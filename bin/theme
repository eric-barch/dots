#!/bin/zsh
THEME="$1"

VALID_THEMES=(
  "catppuccin-mocha" 
  "catppuccin-latte" 
  "onedark" 
  "onelight"
  "onedark_dark"
  "onedark_vivid"
)

if [[ ! " ${VALID_THEMES[@]} " =~ " ${THEME} " ]]; then
  echo "Invalid theme specified: $THEME. Use one of the following:"
  for theme in "${VALID_THEMES[@]}"; do
    echo "  - $theme"
  done
  exit 1
fi

ALACRITTY_CONFIG="$XDG_CONFIG_HOME/alacritty/alacritty.toml"
WEZTERM_CONFIG="$XDG_CONFIG_HOME/wezterm/wezterm.lua"

# Resolve symlinks.
ALACRITTY_CONFIG=$(readlink -f "$ALACRITTY_CONFIG" || echo "$ALACRITTY_CONFIG")
WEZTERM_CONFIG=$(readlink -f "$WEZTERM_CONFIG" || echo "$WEZTERM_CONFIG")

# Swap out theme lines in config files.
sed -i "" "/^[^#]*colors/s|.*|  \"~/.config/alacritty/colors/$THEME.toml\"|" "$ALACRITTY_CONFIG"
sed -i "" "/^[^#]*config.color_scheme/s|.*|config.color_scheme = \"$THEME\"|" "$WEZTERM_CONFIG"

# Re-source tmux.
if tmux has-session &>/dev/null; then
  tmux source-file "$TMUX_CONFIG"
fi
